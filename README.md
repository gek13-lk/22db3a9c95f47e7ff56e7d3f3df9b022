## Описание
"Референс-центр. Планирование" - это сервис для автоматизации составления графика работы врачей-рентгенологов. Сервис использует алгоритмы прогнозирования для оптимизации расписаний, обеспечивая эффективное использование ресурсов и удобство для врачей.

## Начало работы
### Предварительные требования
Убедитесь, что у вас установлены следующие компоненты:

+ Docker
+ Docker Compose
### Установка и запуск
**1. Клонирование репозитория**

```sh
git clone git@github.com:gek13-lk/22db3a9c95f47e7ff56e7d3f3df9b022.git
cd 22db3a9c95f47e7ff56e7d3f3df9b022
```
**2. Сборка и запуск контейнеров Docker**

Сборка контейнеров может занять около 30 минут, так как для алгоритма прогнозирования требуется библиотека scikit-learn и её зависимости, которые устанавливаются достаточно долго. Пожалуйста, наберитесь терпения.

```sh
docker-compose build
docker-compose up -d
```
**3. Переход в контейнер app**

```sh
docker-compose exec app sh
```
**4. Установка зависимостей**

```sh
composer install
```
**5. Создание базы данных и запуск миграций**

```sh
php bin/console doctrine:database:create
php bin/console doctrine:migrations:migrate
```
**6. Обновление справочников**

```sh
php bin/console app:sync:privileges # Справочник привилегий
php bin/console app:holiday:update  # Справочник праздничных дней
```
### Обучение моделей прогнозирования
Модель прогнозирования можно обучить двумя способами.
Обратите внимание, что процесс обучения моделей занимает 12-15 минут.

#### Способ 1: Из контейнера app
Перейдите в контейнер app и запустите команду для обучения моделей.

```sh
docker-compose exec app sh
php bin/console app:models:training
```

#### Способ 2: Из интерфейса системы
Перейдите в контейнер app и запустите прослушивание очереди.

```sh
docker-compose exec app sh
php bin/console messenger:consume async -vv
```
Используйте интерфейс системы для запуска обучения.

1. Перейдите в интерфейс системы.
2. Перейдите на вкладку меню «Методы визуализации», подвкладка «История по неделям».
3. Если необходимо внести новые данные, нажмите на кнопку «Добавить новые данные», расположенную справа над таблицей исторических данных.
4. Нажмите на кнопку «Обновить прогнозы».

После нажатия на кнопку «Обновить прогнозы», сообщение отправится в очередь. Обработчик заберет сообщение из очереди и запустит скрипт обучения.

## Дополнительная информация
1. [Документация Docker](https://docs.docker.com/reference/dockerfile/)
2. [Документация Symfony](https://symfony.com/doc/current/index.html)
3. [Документация scikit-learn](https://scikit-learn.org/stable/user_guide.html)

Если у вас возникнут вопросы или проблемы, пожалуйста, создайте issue в этом репозитории.
